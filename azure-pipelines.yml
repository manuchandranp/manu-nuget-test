parameters:
  - name: BuildConfiguration
    displayName: 'Build Configuration'
    type: string
    default: 'Release'
    values:
      - 'Release'
      - 'Debug'
jobs:
  - job: BuildAndPublish
    displayName: 'Build and Publish to Artifactory'
    pool:
      vmImage: 'windows-latest'
    steps:
      # Checkout the source code
      - checkout: self
      # Install the .NET SDK
      - task: UseDotNet@2
        displayName: 'Install .NET SDK'
        inputs:
          packageType: 'sdk'
          version: '6.x'  # Ensure compatibility
          installationPath: $(Agent.ToolsDirectory)/dotnet
      # Restore NuGet packages
      - task: DotNetCoreCLI@2
        displayName: 'Restore NuGet Packages'
        inputs:
          command: 'restore'
          projects: '**/*.csproj'  # Adjust to ensure this points to your .sln or .csproj files
      # Install dependencies
      - task: JFrogDotnetCore@1
        displayName: 'Install Dependencies'
        inputs:
          command: 'custom'
          customCommand: 'workload'
          arguments: 'install maui-desktop maui-ios'
          artifactoryConnection: 'crm-terraform-us-jfrog-artifactory-private-ep'
          targetResolveRepo: 'manu-nuget-virtual'
          rootPath: '$(Build.SourcesDirectory)'
          username: 'YOUR_USERNAME'  
          accessToken: 'YOUR_ACCESS_TOKEN'

      # Publish artifacts
      - task: PublishBuildArtifacts@1
        displayName: 'Publish Artifacts'
        inputs:
          pathToPublish: '$(Build.SourcesDirectory)/path-to-artifacts'  # Adjust as necessary
          artifactName: 'NuGetArtifacts'
          publishLocation: 'Container'